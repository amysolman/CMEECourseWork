ID_plots_Bar <- subset(ID_plots, Model == "Baranyi")
ID_plots_Buc <- subset(ID_plots, Model == "Buchanan")
ID_plots_Qua <- subset(ID_plots, Model == "Quadratic")
ID_plots_Pol <- subset(ID_plots, Model == "Polynomial")
ID_plots_Lin <- subset(ID_plots, Model == "Linear")
#Plot each dataset of ID with each successful model
p <- ggplot(ID_df, aes(x=t, y=LogN)) +
geom_point() +
xlab("time") +
ylab("logN") +
theme_bw() +
ggtitle("Population Growth", i) +
geom_line(data = ID_plots_Gom, aes(x = t, y = LogN, colour = "Gompertz")) +
geom_line(data = ID_plots_Bar, aes(x = t, y = LogN, colour = "Baranyi")) +
geom_line(data = ID_plots_Buc, aes(x = t, y = LogN, colour = "Buchanan")) +
geom_line(data = ID_plots_Qua, aes(x = t, y = LogN, colour = "Quadratic")) +
geom_line(data = ID_plots_Pol, aes(x = t, y = LogN, colour = "Polynomial")) +
geom_line(data = ID_plots_Lin, aes(x = t, y = LogN, color = "Linear")) +
scale_color_discrete(name = "Models")
plot_list[[i]] <- p
#SAVE BEST MODEL DATA TO DATAFRAME
#Best model in terms of R-squared
R.Squared <- max(ID_stats[,"R.Squared"])
best_model_R <- ID_stats[ID_stats$R.Squared == R.Squared, "Model"]
best_model_R <- as.character(best_model_R)
AIC <- min(abs((ID_stats[,"AIC.Score"])))
best_model_AIC <- ID_stats[ID_stats$AIC.Score == AIC, "Model"]
best_model_AIC <- as.character(best_model_AIC)
BIC <- min(abs((ID_stats[,"BIC.Score"])))
best_model_BIC <- ID_stats[ID_stats$BIC.Score == BIC, "Model"]
best_model_BIC <- as.character(best_model_BIC)
final_stats <- data.frame(i, best_model_R, best_model_AIC, best_model_BIC)
names(final_stats) <- c("ID", "Best R-Sq Model", "Best AIC Model", "Best BIC Model")
#data_frame_list[[i]] <- c(i, best_model_R, best_model_AIC, best_model_BIC)
#write.csv(final_stats, paste0("../results/model_fits/final_stats_",i,".csv"))
show(p)
}
View(final_stats)
View(ID1)
ID1[which.min(abs(ID1[,4])),7]
View(ID1)
for (i in 2:2) {
ID_df<-data[which(data$ID==i),]
ID_plots <- total_plot_results[which(total_plot_results$ID==i),]
ID_stats <- total_stats_results[which(total_stats_results$ID==i),]
ID_stats[ID_stats==0] <- NA
ID_stats[ID_stats==0] <- Inf
ID_stats<-ID_stats[complete.cases(ID_stats$AIC.Score),]
ID_plots_Gom <- subset(ID_plots, Model == "Gompertz")
ID_plots_Bar <- subset(ID_plots, Model == "Baranyi")
ID_plots_Buc <- subset(ID_plots, Model == "Buchanan")
ID_plots_Qua <- subset(ID_plots, Model == "Quadratic")
ID_plots_Pol <- subset(ID_plots, Model == "Polynomial")
ID_plots_Lin <- subset(ID_plots, Model == "Linear")
#Plot each dataset of ID with each successful model
p <- ggplot(ID_df, aes(x=t, y=LogN)) +
geom_point() +
xlab("time") +
ylab("logN") +
theme_bw() +
ggtitle("Population Growth", i) +
geom_line(data = ID_plots_Gom, aes(x = t, y = LogN, colour = "Gompertz")) +
geom_line(data = ID_plots_Bar, aes(x = t, y = LogN, colour = "Baranyi")) +
geom_line(data = ID_plots_Buc, aes(x = t, y = LogN, colour = "Buchanan")) +
geom_line(data = ID_plots_Qua, aes(x = t, y = LogN, colour = "Quadratic")) +
geom_line(data = ID_plots_Pol, aes(x = t, y = LogN, colour = "Polynomial")) +
geom_line(data = ID_plots_Lin, aes(x = t, y = LogN, color = "Linear")) +
scale_color_discrete(name = "Models")
plot_list[[i]] <- p
#SAVE BEST MODEL DATA TO DATAFRAME
#Best model in terms of R-squared
# R.Squared <- max(ID_stats[,"R.Squared"])
# best_model_R <- ID_stats[ID_stats$R.Squared == R.Squared, "Model"]
# best_model_R <- as.character(best_model_R)
#
# AIC <- min(abs((ID_stats[,"AIC.Score"])))
# best_model_AIC <- ID_stats[ID_stats$AIC.Score == +/-(AIC), "Model"]
# best_model_AIC <- as.character(best_model_AIC)
#
# BIC <- min(abs((ID_stats[,"BIC.Score"])))
# best_model_BIC <- ID_stats[ID_stats$BIC.Score == BIC, "Model"]
# best_model_BIC <- as.character(best_model_BIC)
best_model_R <- ID_stats[which.min(ID_stats[,3]),7]
best_model_AIC <- ID_stats[which.min(abs(ID_stats[,4])),7]
best_model_BIC <- ID_stats[which.min(abs(ID_stats[,5])),7]
final_stats <- data.frame(i, best_model_R, best_model_AIC, best_model_BIC)
names(final_stats) <- c("ID", "Best R-Sq Model", "Best AIC Model", "Best BIC Model")
#data_frame_list[[i]] <- c(i, best_model_R, best_model_AIC, best_model_BIC)
#write.csv(final_stats, paste0("../results/model_fits/final_stats_",i,".csv"))
show(p)
}
best_model_AIC
for (i in 2:2) {
ID_df<-data[which(data$ID==i),]
ID_plots <- total_plot_results[which(total_plot_results$ID==i),]
ID_stats <- total_stats_results[which(total_stats_results$ID==i),]
ID_stats[ID_stats==0] <- NA
ID_stats[ID_stats==0] <- Inf
ID_stats<-ID_stats[complete.cases(ID_stats$AIC.Score),]
ID_plots_Gom <- subset(ID_plots, Model == "Gompertz")
ID_plots_Bar <- subset(ID_plots, Model == "Baranyi")
ID_plots_Buc <- subset(ID_plots, Model == "Buchanan")
ID_plots_Qua <- subset(ID_plots, Model == "Quadratic")
ID_plots_Pol <- subset(ID_plots, Model == "Polynomial")
ID_plots_Lin <- subset(ID_plots, Model == "Linear")
#Plot each dataset of ID with each successful model
p <- ggplot(ID_df, aes(x=t, y=LogN)) +
geom_point() +
xlab("time") +
ylab("logN") +
theme_bw() +
ggtitle("Population Growth", i) +
geom_line(data = ID_plots_Gom, aes(x = t, y = LogN, colour = "Gompertz")) +
geom_line(data = ID_plots_Bar, aes(x = t, y = LogN, colour = "Baranyi")) +
geom_line(data = ID_plots_Buc, aes(x = t, y = LogN, colour = "Buchanan")) +
geom_line(data = ID_plots_Qua, aes(x = t, y = LogN, colour = "Quadratic")) +
geom_line(data = ID_plots_Pol, aes(x = t, y = LogN, colour = "Polynomial")) +
geom_line(data = ID_plots_Lin, aes(x = t, y = LogN, color = "Linear")) +
scale_color_discrete(name = "Models")
plot_list[[i]] <- p
#SAVE BEST MODEL DATA TO DATAFRAME
#Best model in terms of R-squared
# R.Squared <- max(ID_stats[,"R.Squared"])
# best_model_R <- ID_stats[ID_stats$R.Squared == R.Squared, "Model"]
# best_model_R <- as.character(best_model_R)
#
# AIC <- min(abs((ID_stats[,"AIC.Score"])))
# best_model_AIC <- ID_stats[ID_stats$AIC.Score == +/-(AIC), "Model"]
# best_model_AIC <- as.character(best_model_AIC)
#
# BIC <- min(abs((ID_stats[,"BIC.Score"])))
# best_model_BIC <- ID_stats[ID_stats$BIC.Score == BIC, "Model"]
# best_model_BIC <- as.character(best_model_BIC)
best_model_R <- ID_stats[which.min(ID_stats[,3]),7]
best_model_R <- as.character(best_model_R)
best_model_AIC <- ID_stats[which.min(abs(ID_stats[,4])),7]
best_model_AIC <- as.character(best_model_AIC)
best_model_BIC <- ID_stats[which.min(abs(ID_stats[,5])),7]
best_model_BIC <- as.character(best_model_BIC)
final_stats <- data.frame(i, best_model_R, best_model_AIC, best_model_BIC)
names(final_stats) <- c("ID", "Best R-Sq Model", "Best AIC Model", "Best BIC Model")
#data_frame_list[[i]] <- c(i, best_model_R, best_model_AIC, best_model_BIC)
#write.csv(final_stats, paste0("../results/model_fits/final_stats_",i,".csv"))
show(p)
}
for (i in 1:2) {
ID_df<-data[which(data$ID==i),]
ID_plots <- total_plot_results[which(total_plot_results$ID==i),]
ID_stats <- total_stats_results[which(total_stats_results$ID==i),]
ID_stats[ID_stats==0] <- NA
ID_stats[ID_stats==0] <- Inf
ID_stats<-ID_stats[complete.cases(ID_stats$AIC.Score),]
ID_plots_Gom <- subset(ID_plots, Model == "Gompertz")
ID_plots_Bar <- subset(ID_plots, Model == "Baranyi")
ID_plots_Buc <- subset(ID_plots, Model == "Buchanan")
ID_plots_Qua <- subset(ID_plots, Model == "Quadratic")
ID_plots_Pol <- subset(ID_plots, Model == "Polynomial")
ID_plots_Lin <- subset(ID_plots, Model == "Linear")
#Plot each dataset of ID with each successful model
p <- ggplot(ID_df, aes(x=t, y=LogN)) +
geom_point() +
xlab("time") +
ylab("logN") +
theme_bw() +
ggtitle("Population Growth", i) +
geom_line(data = ID_plots_Gom, aes(x = t, y = LogN, colour = "Gompertz")) +
geom_line(data = ID_plots_Bar, aes(x = t, y = LogN, colour = "Baranyi")) +
geom_line(data = ID_plots_Buc, aes(x = t, y = LogN, colour = "Buchanan")) +
geom_line(data = ID_plots_Qua, aes(x = t, y = LogN, colour = "Quadratic")) +
geom_line(data = ID_plots_Pol, aes(x = t, y = LogN, colour = "Polynomial")) +
geom_line(data = ID_plots_Lin, aes(x = t, y = LogN, color = "Linear")) +
scale_color_discrete(name = "Models")
plot_list[[i]] <- p
#SAVE BEST MODEL DATA TO DATAFRAME
#Best model in terms of R-squared
# R.Squared <- max(ID_stats[,"R.Squared"])
# best_model_R <- ID_stats[ID_stats$R.Squared == R.Squared, "Model"]
# best_model_R <- as.character(best_model_R)
#
# AIC <- min(abs((ID_stats[,"AIC.Score"])))
# best_model_AIC <- ID_stats[ID_stats$AIC.Score == +/-(AIC), "Model"]
# best_model_AIC <- as.character(best_model_AIC)
#
# BIC <- min(abs((ID_stats[,"BIC.Score"])))
# best_model_BIC <- ID_stats[ID_stats$BIC.Score == BIC, "Model"]
# best_model_BIC <- as.character(best_model_BIC)
best_model_R <- ID_stats[which.min(ID_stats[,3]),7]
best_model_R <- as.character(best_model_R)
best_model_AIC <- ID_stats[which.min(abs(ID_stats[,4])),7]
best_model_AIC <- as.character(best_model_AIC)
best_model_BIC <- ID_stats[which.min(abs(ID_stats[,5])),7]
best_model_BIC <- as.character(best_model_BIC)
final_stats <- data.frame(i, best_model_R, best_model_AIC, best_model_BIC)
names(final_stats) <- c("ID", "Best R-Sq Model", "Best AIC Model", "Best BIC Model")
#data_frame_list[[i]] <- c(i, best_model_R, best_model_AIC, best_model_BIC)
#write.csv(final_stats, paste0("../results/model_fits/final_stats_",i,".csv"))
show(p)
}
for (i in 1:2) {
ID_df<-data[which(data$ID==i),]
ID_plots <- total_plot_results[which(total_plot_results$ID==i),]
ID_stats <- total_stats_results[which(total_stats_results$ID==i),]
ID_stats[ID_stats==0] <- NA
ID_stats[ID_stats==0] <- Inf
ID_stats<-ID_stats[complete.cases(ID_stats$AIC.Score),]
ID_plots_Gom <- subset(ID_plots, Model == "Gompertz")
ID_plots_Bar <- subset(ID_plots, Model == "Baranyi")
ID_plots_Buc <- subset(ID_plots, Model == "Buchanan")
ID_plots_Qua <- subset(ID_plots, Model == "Quadratic")
ID_plots_Pol <- subset(ID_plots, Model == "Polynomial")
ID_plots_Lin <- subset(ID_plots, Model == "Linear")
#Plot each dataset of ID with each successful model
p <- ggplot(ID_df, aes(x=t, y=LogN)) +
geom_point() +
xlab("time") +
ylab("logN") +
theme_bw() +
ggtitle("Population Growth", i) +
geom_line(data = ID_plots_Gom, aes(x = t, y = LogN, colour = "Gompertz")) +
geom_line(data = ID_plots_Bar, aes(x = t, y = LogN, colour = "Baranyi")) +
geom_line(data = ID_plots_Buc, aes(x = t, y = LogN, colour = "Buchanan")) +
geom_line(data = ID_plots_Qua, aes(x = t, y = LogN, colour = "Quadratic")) +
geom_line(data = ID_plots_Pol, aes(x = t, y = LogN, colour = "Polynomial")) +
geom_line(data = ID_plots_Lin, aes(x = t, y = LogN, color = "Linear")) +
scale_color_discrete(name = "Models")
plot_list[[i]] <- p
#SAVE BEST MODEL DATA TO DATAFRAME
#Best model in terms of R-squared
# R.Squared <- max(ID_stats[,"R.Squared"])
# best_model_R <- ID_stats[ID_stats$R.Squared == R.Squared, "Model"]
# best_model_R <- as.character(best_model_R)
#
# AIC <- min(abs((ID_stats[,"AIC.Score"])))
# best_model_AIC <- ID_stats[ID_stats$AIC.Score == +/-(AIC), "Model"]
# best_model_AIC <- as.character(best_model_AIC)
#
# BIC <- min(abs((ID_stats[,"BIC.Score"])))
# best_model_BIC <- ID_stats[ID_stats$BIC.Score == BIC, "Model"]
# best_model_BIC <- as.character(best_model_BIC)
best_model_R <- ID_stats[which.min(ID_stats[,3]),7]
best_model_R <- as.character(best_model_R)
best_model_AIC <- ID_stats[which.min(abs(ID_stats[,4])),7]
best_model_AIC <- as.character(best_model_AIC)
best_model_BIC <- ID_stats[which.min(abs(ID_stats[,5])),7]
best_model_BIC <- as.character(best_model_BIC)
final_stats <- data.frame(i, best_model_R, best_model_AIC, best_model_BIC)
names(final_stats) <- c("ID", "Best R-Sq Model", "Best AIC Model", "Best BIC Model")
#data_frame_list[[i]] <- c(i, best_model_R, best_model_AIC, best_model_BIC)
write.csv(final_stats, paste0("../results/model_fits/final_stats_",i,".csv"))
show(p)
}
for (i in 1:2) {
ID_df<-data[which(data$ID==i),]
ID_plots <- total_plot_results[which(total_plot_results$ID==i),]
ID_stats <- total_stats_results[which(total_stats_results$ID==i),]
ID_stats[ID_stats==0] <- NA
ID_stats[ID_stats==0] <- Inf
ID_stats<-ID_stats[complete.cases(ID_stats$AIC.Score),]
ID_plots_Gom <- subset(ID_plots, Model == "Gompertz")
ID_plots_Bar <- subset(ID_plots, Model == "Baranyi")
ID_plots_Buc <- subset(ID_plots, Model == "Buchanan")
ID_plots_Qua <- subset(ID_plots, Model == "Quadratic")
ID_plots_Pol <- subset(ID_plots, Model == "Polynomial")
ID_plots_Lin <- subset(ID_plots, Model == "Linear")
#Plot each dataset of ID with each successful model
p <- ggplot(ID_df, aes(x=t, y=LogN)) +
geom_point() +
xlab("time") +
ylab("logN") +
theme_bw() +
ggtitle("Population Growth", i) +
geom_line(data = ID_plots_Gom, aes(x = t, y = LogN, colour = "Gompertz")) +
geom_line(data = ID_plots_Bar, aes(x = t, y = LogN, colour = "Baranyi")) +
geom_line(data = ID_plots_Buc, aes(x = t, y = LogN, colour = "Buchanan")) +
geom_line(data = ID_plots_Qua, aes(x = t, y = LogN, colour = "Quadratic")) +
geom_line(data = ID_plots_Pol, aes(x = t, y = LogN, colour = "Polynomial")) +
geom_line(data = ID_plots_Lin, aes(x = t, y = LogN, color = "Linear")) +
scale_color_discrete(name = "Models")
plot_list[[i]] <- p
#SAVE BEST MODEL DATA TO DATAFRAME
#Best model in terms of R-squared
# R.Squared <- max(ID_stats[,"R.Squared"])
# best_model_R <- ID_stats[ID_stats$R.Squared == R.Squared, "Model"]
# best_model_R <- as.character(best_model_R)
#
# AIC <- min(abs((ID_stats[,"AIC.Score"])))
# best_model_AIC <- ID_stats[ID_stats$AIC.Score == +/-(AIC), "Model"]
# best_model_AIC <- as.character(best_model_AIC)
#
# BIC <- min(abs((ID_stats[,"BIC.Score"])))
# best_model_BIC <- ID_stats[ID_stats$BIC.Score == BIC, "Model"]
# best_model_BIC <- as.character(best_model_BIC)
best_model_R <- ID_stats[which.min(ID_stats[,3]),7]
best_model_R <- as.character(best_model_R)
best_model_AIC <- ID_stats[which.min(abs(ID_stats[,4])),7]
best_model_AIC <- as.character(best_model_AIC)
best_model_BIC <- ID_stats[which.min(abs(ID_stats[,5])),7]
best_model_BIC <- as.character(best_model_BIC)
final_stats <- data.frame(i, best_model_R, best_model_AIC, best_model_BIC)
names(final_stats) <- c("ID", "Best R-Sq Model", "Best AIC Model", "Best BIC Model")
data_frame_list[[i]] <- final_stats
#write.csv(final_stats, paste0("../results/model_fits/final_stats_",i,".csv"))
#show(p)
}
View(final_stats)
data_frame_list = list()
for (i in 1:X) {
ID_df<-data[which(data$ID==i),]
ID_plots <- total_plot_results[which(total_plot_results$ID==i),]
ID_stats <- total_stats_results[which(total_stats_results$ID==i),]
ID_stats[ID_stats==0] <- NA
ID_stats[ID_stats==0] <- Inf
ID_stats<-ID_stats[complete.cases(ID_stats$AIC.Score),]
ID_plots_Gom <- subset(ID_plots, Model == "Gompertz")
ID_plots_Bar <- subset(ID_plots, Model == "Baranyi")
ID_plots_Buc <- subset(ID_plots, Model == "Buchanan")
ID_plots_Qua <- subset(ID_plots, Model == "Quadratic")
ID_plots_Pol <- subset(ID_plots, Model == "Polynomial")
ID_plots_Lin <- subset(ID_plots, Model == "Linear")
#Plot each dataset of ID with each successful model
p <- ggplot(ID_df, aes(x=t, y=LogN)) +
geom_point() +
xlab("time") +
ylab("logN") +
theme_bw() +
ggtitle("Population Growth", i) +
geom_line(data = ID_plots_Gom, aes(x = t, y = LogN, colour = "Gompertz")) +
geom_line(data = ID_plots_Bar, aes(x = t, y = LogN, colour = "Baranyi")) +
geom_line(data = ID_plots_Buc, aes(x = t, y = LogN, colour = "Buchanan")) +
geom_line(data = ID_plots_Qua, aes(x = t, y = LogN, colour = "Quadratic")) +
geom_line(data = ID_plots_Pol, aes(x = t, y = LogN, colour = "Polynomial")) +
geom_line(data = ID_plots_Lin, aes(x = t, y = LogN, color = "Linear")) +
scale_color_discrete(name = "Models")
plot_list[[i]] <- p
#SAVE BEST MODEL DATA TO DATAFRAME
best_model_R <- ID_stats[which.min(ID_stats[,3]),7]
best_model_R <- as.character(best_model_R)
best_model_AIC <- ID_stats[which.min(abs(ID_stats[,4])),7]
best_model_AIC <- as.character(best_model_AIC)
best_model_BIC <- ID_stats[which.min(abs(ID_stats[,5])),7]
best_model_BIC <- as.character(best_model_BIC)
final_stats <- data.frame(i, best_model_R, best_model_AIC, best_model_BIC)
names(final_stats) <- c("ID", "Best R-Sq Model", "Best AIC Model", "Best BIC Model")
data_frame_list[[i]] <- final_stats
#write.csv(final_stats, paste0("../results/model_fits/final_stats_",i,".csv"))
#show(p)
}
View(data_frame_list)
merged.data.frame = Reduce(function(...) merge(..., all=T), data_frame_list)
View(data_frame_list)
View(data_frame_list)
library("plyr")
class(data_frame_list)
merged_data <- ldply(data_frame_list, data.frame)
View(merged_data)
View(ID_plots_Buc)
View(total_stats_results)
for (i in 1:X) {
ID_df<-data[which(data$ID==i),]
ID_plots <- total_plot_results[which(total_plot_results$ID==i),]
ID_stats <- total_stats_results[which(total_stats_results$ID==i),]
ID_stats[ID_stats==0] <- NA
ID_stats[ID_stats==0] <- Inf
ID_stats<-ID_stats[complete.cases(ID_stats$AIC.Score),]
ID_plots_Gom <- subset(ID_plots, Model == "Gompertz")
ID_plots_Bar <- subset(ID_plots, Model == "Baranyi")
ID_plots_Buc <- subset(ID_plots, Model == "Buchanan")
ID_plots_Qua <- subset(ID_plots, Model == "Quadratic")
ID_plots_Pol <- subset(ID_plots, Model == "Polynomial")
ID_plots_Lin <- subset(ID_plots, Model == "Linear")
#Plot each dataset of ID with each successful model
p <- ggplot(ID_df, aes(x=t, y=LogN)) +
geom_point() +
xlab("time") +
ylab("logN") +
theme_bw() +
ggtitle("Population Growth", i) +
geom_line(data = ID_plots_Gom, aes(x = t, y = LogN, colour = "Gompertz")) +
geom_line(data = ID_plots_Bar, aes(x = t, y = LogN, colour = "Baranyi")) +
geom_line(data = ID_plots_Buc, aes(x = t, y = LogN, colour = "Buchanan")) +
geom_line(data = ID_plots_Qua, aes(x = t, y = LogN, colour = "Quadratic")) +
geom_line(data = ID_plots_Pol, aes(x = t, y = LogN, colour = "Polynomial")) +
geom_line(data = ID_plots_Lin, aes(x = t, y = LogN, color = "Linear")) +
scale_color_discrete(name = "Models")
plot_list[[i]] <- p
#SAVE BEST MODEL DATA TO DATAFRAME
best_model_R <- ID_stats[which.max(ID_stats[,3]),7]
best_model_R <- as.character(best_model_R)
best_model_AIC <- ID_stats[which.min(abs(ID_stats[,4])),7]
best_model_AIC <- as.character(best_model_AIC)
best_model_BIC <- ID_stats[which.min(abs(ID_stats[,5])),7]
best_model_BIC <- as.character(best_model_BIC)
final_stats <- data.frame(i, best_model_R, best_model_AIC, best_model_BIC)
names(final_stats) <- c("ID", "Best R-Sq Model", "Best AIC Model", "Best BIC Model")
data_frame_list[[i]] <- final_stats
}
View(merged_data)
View(merged.data.frame)
View(merged_data)
Gompertz <- length(grep("Gompertz", merged_data[2]))
length(grep("Gompertz", merged_data[2]))
length(grep("Gompertz", merged_data[3]))
length(grep(Gompertz, merged_data[3]))
merged_data[3]
length(grep(Linear, merged_data[3]))
length(grep("Linear", merged_data[3]))
library("stringr")
sum(str_count(merged_data[2], "Linear"))
sum(str_count(merged_data, "Linear"))
length(grep("Linear", merged_data))
length(merged_data[which(merged_data=="Linear")])
length(merged_data[which(merged_data[2]=="Linear")])
for (i in 1:3) {
ID_df<-data[which(data$ID==i),]
ID_plots <- total_plot_results[which(total_plot_results$ID==i),]
ID_stats <- total_stats_results[which(total_stats_results$ID==i),]
ID_stats[ID_stats==0] <- NA
ID_stats[ID_stats==0] <- Inf
ID_stats<-ID_stats[complete.cases(ID_stats$AIC.Score),]
ID_plots_Gom <- subset(ID_plots, Model == "Gompertz")
ID_plots_Bar <- subset(ID_plots, Model == "Baranyi")
ID_plots_Buc <- subset(ID_plots, Model == "Buchanan")
ID_plots_Qua <- subset(ID_plots, Model == "Quadratic")
ID_plots_Pol <- subset(ID_plots, Model == "Polynomial")
ID_plots_Lin <- subset(ID_plots, Model == "Linear")
#Plot each dataset of ID with each successful model
p <- ggplot(ID_df, aes(x=t, y=LogN)) +
geom_point() +
xlab("time") +
ylab("logN") +
theme_bw() +
ggtitle("Population Growth", i) +
geom_line(data = ID_plots_Gom, aes(x = t, y = LogN, colour = "Gompertz")) +
geom_line(data = ID_plots_Bar, aes(x = t, y = LogN, colour = "Baranyi")) +
geom_line(data = ID_plots_Buc, aes(x = t, y = LogN, colour = "Buchanan")) +
geom_line(data = ID_plots_Qua, aes(x = t, y = LogN, colour = "Quadratic")) +
geom_line(data = ID_plots_Pol, aes(x = t, y = LogN, colour = "Polynomial")) +
geom_line(data = ID_plots_Lin, aes(x = t, y = LogN, color = "Linear")) +
scale_color_discrete(name = "Models")
plot_list[[i]] <- p
#SAVE BEST MODEL DATA TO DATAFRAME
best_model_R <- ID_stats[which.max(ID_stats[,3]),7]
best_model_R <- as.character(best_model_R)
best_model_AIC <- ID_stats[which.min(abs(ID_stats[,4])),7]
best_model_AIC <- as.character(best_model_AIC)
best_model_BIC <- ID_stats[which.min(abs(ID_stats[,5])),7]
best_model_BIC <- as.character(best_model_BIC)
final_stats <- data.frame(i, best_model_R, best_model_AIC, best_model_BIC)
names(final_stats) <- c("ID", "Best R-Sq Model", "Best AIC Model", "Best BIC Model")
data_frame_list[[i]] <- final_stats
}
View(merged_data)
#merge the list of dataframes in to one
merged_data <- ldply(data_frame_list, data.frame)
View(merged_data)
for (i in 1:X) {
ID_df<-data[which(data$ID==i),]
ID_plots <- total_plot_results[which(total_plot_results$ID==i),]
ID_stats <- total_stats_results[which(total_stats_results$ID==i),]
ID_stats[ID_stats==0] <- NA
ID_stats[ID_stats==0] <- Inf
ID_stats<-ID_stats[complete.cases(ID_stats$AIC.Score),]
ID_plots_Gom <- subset(ID_plots, Model == "Gompertz")
ID_plots_Bar <- subset(ID_plots, Model == "Baranyi")
ID_plots_Buc <- subset(ID_plots, Model == "Buchanan")
ID_plots_Qua <- subset(ID_plots, Model == "Quadratic")
ID_plots_Pol <- subset(ID_plots, Model == "Polynomial")
ID_plots_Lin <- subset(ID_plots, Model == "Linear")
#Plot each dataset of ID with each successful model
p <- ggplot(ID_df, aes(x=t, y=LogN)) +
geom_point() +
xlab("time") +
ylab("logN") +
theme_bw() +
ggtitle("Population Growth", i) +
geom_line(data = ID_plots_Gom, aes(x = t, y = LogN, colour = "Gompertz")) +
geom_line(data = ID_plots_Bar, aes(x = t, y = LogN, colour = "Baranyi")) +
geom_line(data = ID_plots_Buc, aes(x = t, y = LogN, colour = "Buchanan")) +
geom_line(data = ID_plots_Qua, aes(x = t, y = LogN, colour = "Quadratic")) +
geom_line(data = ID_plots_Pol, aes(x = t, y = LogN, colour = "Polynomial")) +
geom_line(data = ID_plots_Lin, aes(x = t, y = LogN, color = "Linear")) +
scale_color_discrete(name = "Models")
plot_list[[i]] <- p
#SAVE BEST MODEL DATA TO DATAFRAME
best_model_R <- ID_stats[which.max(ID_stats[,3]),7]
best_model_R <- as.character(best_model_R)
best_model_AIC <- ID_stats[which.min(abs(ID_stats[,4])),7]
best_model_AIC <- as.character(best_model_AIC)
best_model_BIC <- ID_stats[which.min(abs(ID_stats[,5])),7]
best_model_BIC <- as.character(best_model_BIC)
final_stats <- data.frame(i, best_model_R, best_model_AIC, best_model_BIC)
names(final_stats) <- c("ID", "Best R-Sq Model", "Best AIC Model", "Best BIC Model")
data_frame_list[[i]] <- final_stats
}
#merge the list of dataframes in to one
merged_data <- ldply(data_frame_list, data.frame)
View(merged_data)
library("dplyr")
merged_data %>% count(Best.R.Sq.Model)
merged_data %>% count(Polynomial)
merged_data %>% count(AIC.Score)
merged_data %>% tally()
merged_data %>% tally(Linear)
merged_data %>% tally("Linear")
class(merged_data$Best.R.Sq.Model)
table(merged_data$Best.R.Sq.Model)
R_Squared <- table(merged_data$Best.R.Sq.Model)
AIC <- table(merged_data$Best.AIC.Model)
BIC <- table(merged_data$Best.BIC.Model)
AIC
BIC
class(AIC)
