return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
#Let's get our mean data
data <- read.csv("../../Results/Simulation/TotalMeanResults.csv")
plot(Species_Rich ~ area, data = data)
#To run the model fitting we need our island areas and species richness, as well as starting values for theta, m0 and K
nu = 0.001
rm(list=ls())
graphics.off()
#install nlls fitting package
#install.packages("minpack.lm") <- if you've never installed minpack before
library("minpack.lm") #for nlls fitting
chisholm_model <- function(area, theta, m0, K) {
rho = 1
K = K
Js = area*rho
J_stars = Js/K
ms = m0/sqrt(area)
gamma_stars = J_stars*ms/(1-ms)
return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
#Let's get our mean data
data <- read.csv("../../Results/Simulation/TotalMeanResults.csv")
#To run the model fitting we need our island areas and species richness, as well as starting values for theta, m0 and K
nu = 0.001
theta <- nu*(sum(data$area-1)/(1-nu))
m <- 0.01
m0 <- m*sqrt(sum(data$area))
K <- 10
#fit the model
fit_chisholm <- nlsLM(Species_Rich ~ chisholm_model(area, theta, m0, K), data = data, start = list(theta = theta, m0 = m0, K=K))
summary(fit_chisholm)
RSS <- sum(residuals(fit_chisholm)^2) #Residual sum of squares of our NLLS model
TSS <- sum((data$Species_Rich - mean(data$Species_Rich))^2) #Total sum of squares
RSq <- 1 - (RSS/TSS) #R-squared value
mean_m0 <- mean(data$migration)*sqrt(sum(data$area))
mean_niches <- mean(data$niches)
results <- data.frame(RSq, coef(fit_chisholm)["theta"], coef(fit_chisholm)["m0"], mean_m0, coef(fit_chisholm)["K"], mean_niches)
names(results) <- c("R-Squared", "EstTheta", "EstM0", "MeanM0", "EstNiches", "MeanNiches")
area <- data$area
species <- data$Species_Rich
chisholm_points <- chisholm_model(area = area, theta = coef(fit_chisholm)["theta"], m0 = coef(fit_chisholm)["m0"], K = coef(fit_chisholm)["K"])
df1 <- data.frame(area, chisholm_points)
df1$Model <- "Chisholm Model"
names(df1) <- c("Area", "Species","ModelOrSim")
df2 <- data.frame(area, species)
df2$Model <- "Solman Sim"
names(df2) <- c("Area", "Species", "ModelOrSim")
df <- rbind(df1, df2)
View(df)
write.csv(df, "../../Results/Simulation/NLLSMeanPlotPoints.csv", row.names = FALSE)
rm(list=ls())
graphics.off()
library("ggplot2")
data <- read.csv("../../Results/Simulation/NLLSMeanPlotPoints.csv")
View(data)
ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point()
ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim))
ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
theme(legend.title = element_blank())
ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model to Solman Simulation Data")
ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
p1 <- ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(aes(colour=ModelOrSim))+
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
p1
p1 <- ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
#geom_line(aes(colour=ModelOrSim))+
geom_smooth(method = "lm", alpha = .15, aes(fill = ModelOrSim)) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
p1
p1 <- ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
#geom_line(aes(colour=ModelOrSim))+
#geom_smooth(method = "lm", alpha = .15, aes(fill = ModelOrSim)) +
geom_line(data = data, aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
p1
p1 <- ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
#geom_line(aes(colour=ModelOrSim))+
#geom_smooth(method = "lm", alpha = .15, aes(fill = ModelOrSim)) +
geom_line(data = data[data$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
p1
p1 <- ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
#geom_line(aes(colour=ModelOrSim))+
#geom_smooth(method = "lm", alpha = .15, aes(fill = ModelOrSim)) +
#geom_line(data = data[data$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
p1
p1 <- ggplot(data, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
#geom_line(aes(colour=ModelOrSim))+
#geom_smooth(method = "lm", alpha = .15, aes(fill = ModelOrSim)) +
geom_line(data = data[data$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
p1
rm(list=ls())
graphics.off()
#install nlls fitting package
#install.packages("minpack.lm") <- if you've never installed minpack before
library("minpack.lm") #for nlls fitting
library("ggplot2")
chisholm_model <- function(area, theta, m0, K) {
rho = 1
K = K
Js = area*rho
J_stars = Js/K
ms = m0/sqrt(area)
gamma_stars = J_stars*ms/(1-ms)
return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
#Let's get our mean data
data <- read.csv("../../Results/Simulation/TotalMeanResults.csv")
#To run the model fitting we need our island areas and species richness, as well as starting values for theta, m0 and K
nu = 0.001
theta <- nu*(sum(data$area-1)/(1-nu))
m <- 0.01
m0 <- m*sqrt(sum(data$area))
K <- 10
#fit the model
fit_chisholm <- nlsLM(Species_Rich ~ chisholm_model(area, theta, m0, K), data = data, start = list(theta = theta, m0 = m0, K=K))
summary(fit_chisholm)
RSS <- sum(residuals(fit_chisholm)^2) #Residual sum of squares of our NLLS model
TSS <- sum((data$Species_Rich - mean(data$Species_Rich))^2) #Total sum of squares
RSq <- 1 - (RSS/TSS) #R-squared value
mean_m0 <- mean(data$migration)*sqrt(sum(data$area))
mean_niches <- mean(data$niches)
results <- data.frame(RSq, coef(fit_chisholm)["theta"], coef(fit_chisholm)["m0"], mean_m0, coef(fit_chisholm)["K"], mean_niches)
names(results) <- c("R-Squared", "EstTheta", "EstM0", "MeanM0", "EstNiches", "MeanNiches")
area <- data$area
species <- data$Species_Rich
chisholm_points <- chisholm_model(area = area, theta = coef(fit_chisholm)["theta"], m0 = coef(fit_chisholm)["m0"], K = coef(fit_chisholm)["K"])
df1 <- data.frame(area, chisholm_points)
df1$Model <- "Chisholm Model"
names(df1) <- c("Area", "Species","ModelOrSim")
df2 <- data.frame(area, species)
df2$Model <- "Solman Sim"
names(df2) <- c("Area", "Species", "ModelOrSim")
df <- rbind(df1, df2)
p1 <- ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = data[data$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
pdf("../../Results/Simulation/NLLSFit.pdf")
print(p1)
View(df)
p1 <- ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
pdf("../../Results/Simulation/NLLSFit.pdf")
print(p1)
write.csv(results, "../../Results/Simulation/NLLSMeanStats.csv", row.names = FALSE)
dev.off()
p1 <- ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=3, y=30, label= c("R-Squared: ", RSq))
p1
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
rm(list=ls())
graphics.off()
#install nlls fitting package
#install.packages("minpack.lm") <- if you've never installed minpack before
library("minpack.lm") #for nlls fitting
library("ggplot2")
chisholm_model <- function(area, theta, m0, K) {
rho = 1
K = K
Js = area*rho
J_stars = Js/K
ms = m0/sqrt(area)
gamma_stars = J_stars*ms/(1-ms)
return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
#Let's get our mean data
data <- read.csv("../../Results/Simulation/TotalMeanResults.csv")
#To run the model fitting we need our island areas and species richness, as well as starting values for theta, m0 and K
nu = 0.001
theta <- nu*(sum(data$area-1)/(1-nu))
m <- 0.01
m0 <- m*sqrt(sum(data$area))
K <- 10
#fit the model
fit_chisholm <- nlsLM(Species_Rich ~ chisholm_model(area, theta, m0, K), data = data, start = list(theta = theta, m0 = m0, K=K))
summary(fit_chisholm)
RSS <- sum(residuals(fit_chisholm)^2) #Residual sum of squares of our NLLS model
TSS <- sum((data$Species_Rich - mean(data$Species_Rich))^2) #Total sum of squares
RSq <- 1 - (RSS/TSS) #R-squared value
mean_m0 <- mean(data$migration)*sqrt(sum(data$area))
mean_niches <- mean(data$niches)
results <- data.frame(RSq, coef(fit_chisholm)["theta"], coef(fit_chisholm)["m0"], mean_m0, coef(fit_chisholm)["K"], mean_niches)
names(results) <- c("R-Squared", "EstTheta", "EstM0", "MeanM0", "EstNiches", "MeanNiches")
area <- data$area
species <- data$Species_Rich
chisholm_points <- chisholm_model(area = area, theta = coef(fit_chisholm)["theta"], m0 = coef(fit_chisholm)["m0"], K = coef(fit_chisholm)["K"])
df1 <- data.frame(area, chisholm_points)
df1$Model <- "Chisholm Model"
names(df1) <- c("Area", "Species","ModelOrSim")
df2 <- data.frame(area, species)
df2$Model <- "Solman Sim"
names(df2) <- c("Area", "Species", "ModelOrSim")
df <- rbind(df1, df2)
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data")
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=3, y=30, label= "R-Squared")
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=200, y=5, label= "R-Squared")
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=200, y=5, label= c("R-Squared", RSq))
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=200, y=5, label= RSq)
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=200, y=5, label= round(RSq, digits = 2))
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=200, y=5, label= "R-Squared:") +
geom-text(x=150, y = 5, label = round(RSq, digits = 2))
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=150, y=5, label= "R-Squared:") +
geom_text(x=200, y = 5, label = round(RSq, digits = 2))
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=150, y=5, label= "R-Squared:") +
geom_text(x=180, y = 5, label = round(RSq, digits = 2))
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=150, y=5, label= "R-Squared:") +
geom_text(x=180, y = 5, label = round(RSq, digits = 2)) +
geom_text(x=150, y = 4, label = "Theta:") +
geom_text(x=180, y=4, label = coef(fit_chisholm)["theta"])
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=150, y=5, label= "R-Squared:") +
geom_text(x=180, y =5, label = round(RSq, digits = 2)) +
geom_text(x=150, y =4, label = "Theta:") +
geom_text(x=180, y=4, label = round(coef(fit_chisholm)["theta"], digits = 2))
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=150, y=5, label= "R-Squared:") +
geom_text(x=180, y =5, label = round(RSq, digits = 2)) +
geom_text(x=150, y =4, label = "Theta:") +
geom_text(x=180, y=4, label = round(coef(fit_chisholm)["theta"], digits = 2)) +
geom_text(x=150, y=3, label = "m0:") +
geom_text(x=180, y=3, label = round(coef(fit_chisholm)["m0"], digits = 2))
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=150, y=5, label= "R-Squared:") +
geom_text(x=180, y =5, label = round(RSq, digits = 2)) +
geom_text(x=150, y =4, label = "Theta:") +
geom_text(x=180, y=4, label = round(coef(fit_chisholm)["theta"], digits = 2)) +
geom_text(x=150, y=3, label = "m0:") +
geom_text(x=180, y=3, label = round(coef(fit_chisholm)["m0"], digits = 2)) +
geom_text(x=150, y=2, label= "Niches:") +
geom_text(x=180, y=2, label= round(coef(fit_chisholm)["K"], digits = 2))
ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=150, y=6, label= "R-Squared:") +
geom_text(x=180, y =6, label = round(RSq, digits = 2)) +
geom_text(x=150, y =5, label = "Theta:") +
geom_text(x=180, y=5, label = round(coef(fit_chisholm)["theta"], digits = 2)) +
geom_text(x=150, y=4, label = "m0:") +
geom_text(x=180, y=4, label = round(coef(fit_chisholm)["m0"], digits = 2)) +
geom_text(x=150, y=3, label= "Niches:") +
geom_text(x=180, y=3, label= round(coef(fit_chisholm)["K"], digits = 2))
p1 <- ggplot(df, aes(x = Area, y = Species, group = ModelOrSim)) +
geom_point(aes(colour = ModelOrSim)) +
geom_line(data = df[df$ModelOrSim == "Chisholm Model", ], aes(x = Area, y = Species, colour = "Chisholm Model")) +
theme(legend.title = element_blank()) +
labs(title="NLLS Fitting of Chisholm Model \nto Solman Simulation Data") +
geom_text(x=150, y=6, label= "R-Squared:") +
geom_text(x=180, y =6, label = round(RSq, digits = 2)) +
geom_text(x=150, y =5, label = "Theta:") +
geom_text(x=180, y=5, label = round(coef(fit_chisholm)["theta"], digits = 2)) +
geom_text(x=150, y=4, label = "m0:") +
geom_text(x=180, y=4, label = round(coef(fit_chisholm)["m0"], digits = 2)) +
geom_text(x=150, y=3, label= "Niches:") +
geom_text(x=180, y=3, label= round(coef(fit_chisholm)["K"], digits = 2))
pdf("../../Results/Simulation/NLLSFit.pdf")
print(p1)
dev.off()
rm(list=ls())
graphics.off()
#library("ggplot2")
library("broom") # tidy() function
#Find import the results of the simulation
ImportMe <- function() {
SimData <- read.csv("../../Data/SimData/SimModelFitData.csv") #import data
SimOrModel <- rep("Solman_Sim", nrow(SimData)) #create a bind SimOrModel column
SimData <- cbind.data.frame(SimData, SimOrModel)
return(SimData)
}
#define the model function
chisholm_model <- function(area, theta, m0, K) {
rho = 1
K = K
Js = area*rho
J_stars = Js/K
ms = m0/sqrt(area)
gamma_stars = J_stars*ms/(1-ms)
return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
#function to compare total results to model
compare_results <- function() {
SimData <- ImportMe()
#create empty list for storing estimated species richness
island_species <- vector()
EstData <- SimData[, -c(5:6)] #copy my simulation data
for (i in 1: nrow(EstData)) {
data <- EstData[i, ]
m = data$migration_rate
area = data$area
J = area
m0 = m*sqrt(area)
nu = 0.001
theta = 2*J*nu
K = data$K_num
island_species[[i]] <- round(chisholm_model(area, theta, m0, K), digits = 2)
}
#bind results to single dataframe
EstData <- cbind.data.frame(EstData, island_species)
#Add a SimOrModel column
SimOrModel <- rep("Chisholm_Model", nrow(EstData))
EstData <- cbind.data.frame(EstData, SimOrModel)
#bind both datasets
TotalData <- rbind.data.frame(SimData, EstData)
return(TotalData)
}
###RUN CHISHOLMS FUNCTION AND GET OUR ESTIMATES
StartData <- compare_results()
div = 1
#Divide TotalData to include only the low half of island sizes
TotalData <- StartData[StartData$area <= max(StartData$area)/div, ]
#divide up the datasets for ease of analysis
SolmanData <- TotalData[TotalData$SimOrModel == "Solman_Sim", ]
ChisholmData <- TotalData[TotalData$SimOrModel == "Chisholm_Model", ]
maxArea <- max(SolmanData$area)
write.csv(maxArea, paste0("../../Results/Simulation/maxArea_", div, ".csv"), row.names = FALSE)
my_data <- list()
for (m in 1:length(unique(SolmanData$migration_rates))) {
migration_rates <- unique(SolmanData$migration_rates)
rate <- SolmanData[SolmanData$migration_rates == migration_rates[m], ]
my_data[[m]] <- rate
}
my_new_data <- list()
y <- 1
for (i in 1:length(my_data)) {
x <- my_data[[i]]
for (a in 1:length(unique(x$area))) {
area <- unique(x$area)
rate <- x[x$area == area[a], ]
my_new_data[[y]] <- rate
y <<- y + 1
}
}
my_new_new_data <- list()
z <- 1
for (i in 1:length(my_new_data)) {
x <- my_new_data[[i]]
for (k in 1:length(unique(x$K_num))) {
niches <- unique(x$K_num)
rate <- x[x$K_num == niches[k], ]
my_new_new_data[[z]] <- rate
z <<- z + 1
}
}
mean_df <- list()
for (a in 1:length(my_new_new_data)) {
dt <- my_new_new_data[a]
b <- dt[[1]]
mean_sp <- mean(b$island_species)
migration_rate <- b$migration_rates[[1]]
area <- b$area[[1]]
niches <- b$K_num[[1]]
mean_df[[a]] <- cbind(migration_rate, area, niches, mean_sp)
}
total_mean <- do.call("rbind", mean_df)
SolmanMean <- as.data.frame(total_mean)
write.csv(SolmanMean, paste0("../../Results/Simulation/SolmanMean_", div, ".csv"), row.names = FALSE)
####LETS MAKE A BOX PLOT OF SIMULATED AND ESTIMATED SPECIES RICHNESSES
#Outliers should appear as circles in our boxplots
file_name = paste("../../Results/Simulation/SolmanChisholmBoxplot_", div, ".pdf", sep="")
pdf(file_name)
b1 <- boxplot(TotalData$island_species ~ TotalData$SimOrModel, col = c("red", "blue"), ylab = "Num_Species")
print(b1)
dev.off()
S <- range(SolmanData$island_species) # 1 - 33
x <- toString(S[1])
y <- toString(S[2])
Solman <- paste(x, "-", y)
C <- range(ChisholmData$island_species) # 1 - 20.88
x <- toString(C[1])
y <- toString(C[2])
Chisholm <- paste(x, "-", y)
ranges <- rbind(Solman, Chisholm)
#Variance is the deviation from the mean of each datapoint,
#squared then divided by the number of datapoints
#minus one
Solman_var <- var(SolmanData$island_species)
Chisholm_var <- var(ChisholmData$island_species)
variances <- rbind(Solman_var, Chisholm_var)
variances <- round(variances, digits = 3)
#if we square root the variance we get the standard deviation
Solman_sd <- sd(SolmanData$island_species) #4.81
Chisholm_sd <- sd(ChisholmData$island_species) #5.83
SDs <- rbind(Solman_sd, Chisholm_sd)
SDs <- round(SDs, digits = 3)
#Standard errors are a good way to display uncertainty
Solman_se <- sqrt(var(SolmanData$island_species)/length(SolmanData$island_species))
Chisholm_se <- sqrt(var(ChisholmData$island_species)/length(ChisholmData$island_species))
SEs <- rbind(Solman_se, Chisholm_se)
SEs <- round(SEs, digits = 3)
#Let's bind these statistics into a dataframe so we can export them as a csv file
MyStats <- as.data.frame(cbind(ranges, variances, SDs, SEs))
names(MyStats) <- c("Range", "Variance", "Standard Deviation", "Standard Error")
write.csv(MyStats, paste0("../../Results/Simulation/MyStats_", div, ".csv"), row.names = FALSE)
####HISTOGRAM OF SOLMAN SPECIES RICHNESS
file_name = paste("../../Results/Simulation/SolmanSpeciesHistogram_", div, ".pdf", sep="")
pdf(file_name)
h1 <- hist(SolmanData$island_species) #produces left skewed data
print(h1)
dev.off()
######HISTOGRAM OF ISLAND AREAS
file_name = paste("../../Results/Simulation/SolmanAreaHistogram_", div, ".pdf", sep="")
pdf(file_name)
h2 <- hist(SolmanData$area)
print(h2)
dev.off()
######HISTOGRAM OF NICHES
file_name = paste("../../Results/Simulation/SolmanNicheHistogram_", div, ".pdf", sep="")
pdf(file_name)
h3 <- hist(SolmanData$K_num)
print(h3)
dev.off()
?pairs
