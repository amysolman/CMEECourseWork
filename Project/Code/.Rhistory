library("plyr")
library("dplyr")
data <- read.csv('../data/modified_data.csv')
rm(list=ls())
rho = 1
theta = 200
K = 10
m0 = 0.0005 #arbitraty immigration rate parameter for hypothetical reference island
A0 = 1 #arbitrary area parameter for hypothetical reference island
AonA0s = 10^seq(log10(10^3),log10(10^10),length.out=22) #
Class(AonA0s)
class(AonA0s)
View(AonA0s)
As = A0*AonA0s #number of species observed on hypothetical reference island generated by multiplying area parameter and vector
a = m0*sqrt(A0)
a
view(a)
View(a)
b = sqrt(A0)/sqrt(A)
b = sqrt(A0)/sqrt(As)
b
sqrt(A0)
sqrt(As)
rm(list=ls())
graphics.off()
library("minpack.lm")
chisholm_model <- function(theta, K, J_stars, gamma_stars) {
return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
rho = 1
theta = 200
K = 10
m0 = 0.0005
A0 = 1
AonA0s = 10^seq(log10(10^3),log10(10^10),length.out=22)
As = A0*AonA0s
Js = As*rho
J_stars = Js/K
ms = m0*sqrt(A0)/sqrt(As)
gamma_stars = J_stars*ms/(1-ms)
plot(AonA0s, As)
species_rich <- c(1, 1, 3, 4, 4, 6, 10, 15, 15, 19, 25, 31, 47, 56, 53, 54, 56, 58, 58, 58)
area <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
data <- data.frame(species_rich, area)
rho = 1
theta = 200
K = 10
#m0 = 0.0005
#A0 = 1
#AonA0s = 10^seq(log10(10^3),log10(10^10),length.out=22)
#As = A0*AonA0s
Js = data$area*rho
J_stars = Js/K
ms = K/sqrt(data$area)
View(ms)
sqrt(data$area)
m0 = 0.0005
A0 = 1
ms = m0*sqrt(A0)/sqrt(As)
View(ms)
ms
ms[1]
ms[20]
rho = 1
theta = 200
K = 10
m0 = 0.0005
A0 = 1
AonA0s = 10^seq(log10(10^3),log10(10^10),length.out=22)
As = A0*AonA0s
Js = As*rho
J_stars = Js/K
ms = m0*sqrt(A0)/sqrt(As)
gamma_stars = J_stars*ms/(1-ms)
ms
View(ms)
species_rich <- c(1, 1, 3, 4, 4, 6, 10, 15, 15, 19, 25, 31, 47, 56, 53, 54, 56, 58, 58, 58)
area <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
data <- data.frame(species_rich, area)
rho = 1
theta = 200
K = 10
m0 = 0.0005
A0 = 1
#AonA0s = 10^seq(log10(10^3),log10(10^10),length.out=22)
#As = A0*AonA0s
Js = data$area*rho
J_stars = Js/K
ms = m0*sqrt(A0)/sqrt(data$area)
gamma_stars = J_stars*ms/(1-ms)
plot(data$species_rich, data$area) #plot area vs species
plot(data$area, data$species_rich) #plot area vs species
theta
K
gamma_stars
J_stars
chisholm_fit <- nlsLM(species_rich ~ chisholm_model(theta, K, gamma_stars, J_stars), data = data, start = list(theta=theta, K=K, gamma_stars=gamma_stars, J_stars=J_stars))
rm(list=ls())
rho = 1
theta = 200
K = 10
m0 = 0.0005
A0 = 1
AonA0s = 10^seq(log10(10^3),log10(10^10),length.out=22)
As = A0*AonA0s
Js = As*rho
J_stars = Js/K
ms = m0*sqrt(A0)/sqrt(As)
gamma_stars = J_stars*ms/(1-ms)
Ss = theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K))
Ss
ms = sqrt(data$area)/data$area #immigration rate = immigration rate at area 1* square root of area 1/
ms = sqrt(data$area)/(data$area() #immigration rate = immigration rate at area 1* square root of area 1/
ms = sqrt(data$area)/(data$area) #immigration rate = immigration rate at area 1* square root of area 1/
data$area
species_rich <- c(1, 1, 3, 4, 4, 6, 10, 15, 15, 19, 25, 31, 47, 56, 53, 54, 56, 58, 58, 58)
area <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
data <- data.frame(species_rich, area)
ms = sqrt(data$area)/(data$area) #immigration rate = immigration rate at area 1* square root of area 1/
ms
data$area
rm(list=ls())
graphics.off()
#install nlls fitting package
library("minpack.lm")
#create a function object for the model
chisholm_model <- function(theta, K, J_stars, gamma_stars) {
return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
#import the data
#My dummy dataset
species_rich <- c(1, 1, 3, 4, 4, 6, 10, 15, 15, 19, 25, 31, 47, 56, 53, 54, 56, 58, 58, 58)
area <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
data <- data.frame(species_rich, area)
#define the starting values for model fitting
rho = 1 #number of individuals per unit area
theta = 200 #equivalent to fishers alpha, diversity index typically between 1 - 200
K = 10
rm(list=ls())
rho = 1
theta = 200
K = 10
m0 = 0.0005
A0 = 1
AonA0s = 10^seq(log10(10^3),log10(10^10),length.out=22)
As = A0*AonA0s
Js = As*rho
J_stars = Js/K
ms = m0*sqrt(A0)/sqrt(As)
gamma_stars = J_stars*ms/(1-ms)
Ss = theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K))
library(sfsmisc)
graphics.off()
par(mar=c(6,5,4,2))
plot(As,Ss,log='x',type='l',
xlim=c(min(As),1e9),ylim=c(0,200),pch=19,
xlab=expression('Area ('*italic(A)*')'),ylab=expression('Species richness ('*italic(S)*')'),
cex=2,cex.lab=2,cex.axis=2,lwd=2,
cex.main=2,xaxt='n',col='grey')
eaxis(1,10^seq(0,10,2),cex.axis=2,padj=0.2)
species_rich <- c(1, 1, 3, 4, 4, 6, 10, 15, 15, 19, 25, 31, 47, 56, 53, 54, 56, 58, 58, 58)
area <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
data <- data.frame(species_rich, area)
As = data$area
Js = As*rho
J_stars = Js/K
ms = m0*sqrt(A0)/sqrt(As)
gamma_stars = J_stars*ms/(1-ms)
Ss = theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K))
library(sfsmisc)
graphics.off()
par(mar=c(6,5,4,2))
plot(As,Ss,log='x',type='l',
xlim=c(min(As),1e9),ylim=c(0,200),pch=19,
xlab=expression('Area ('*italic(A)*')'),ylab=expression('Species richness ('*italic(S)*')'),
cex=2,cex.lab=2,cex.axis=2,lwd=2,
cex.main=2,xaxt='n',col='grey')
eaxis(1,10^seq(0,10,2),cex.axis=2,padj=0.2)
rm(list=ls())
graphics.off()
#install nlls fitting package
library("minpack.lm")
#create a function object for the model
chisholm_model <- function(theta, K, J_stars, gamma_stars) {
return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
#import the data
#My dummy dataset
species_rich <- c(1, 1, 3, 4, 4, 6, 10, 15, 15, 19, 25, 31, 47, 56, 53, 54, 56, 58, 58, 58)
area <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
data <- data.frame(species_rich, area)
#define the starting values for model fitting
rho = 1 #number of individuals per unit area
theta = 200 #equivalent to fishers alpha, diversity index typically between 1 - 200
K = 10 #number of niches
#parameters A0 and m0 are used to define the area and immigration rate of some hypothetical reference island
#--essentially it defines one point on the m versus A curve
m0 = 0.0005 #immigration rate when island area is 1 (A0)
A0 = 1 #island area
Js = data$area*rho #total number of individuals on each island
J_stars = Js/K #number of individuals per niche on each island
ms = m0*sqrt(A0)/sqrt(data$area) #estimated immigration rate of each island
gamma_stars = J_stars*ms/(1-ms)
#plot area vs species
plot(data$area, data$species_rich)
#fit the model to the data using nlls
chisholm_fit <- nlsLM(species_rich ~ chisholm_model(theta, K, gamma_stars, J_stars), data = data, start = list(theta=theta, K=K, gamma_stars=gamma_stars, J_stars=J_stars))
setwd("~/Documents/CMEECourseWork/Project/Code")
rm(list=ls())
graphics.off()
#install nlls fitting package
#install.packages("minpack.lm") <- if you've never installed minpack before
library("minpack.lm") #for nlls fitting
library("ggplot2")
folder <- "../Data/"  # path to folder that holds multiple .csv files
file_list <- list.files(path=folder, pattern="*.csv") # create list of all .csv files in folder
#load the csv files into a list
datasets <- lapply(file_list,
function(x)
read.csv(paste(folder, x, sep = ''),
stringsAsFactors = FALSE))
points_list <- list() #for storing our fitted points for plotting
results_list <- list() #for storing our RSq and parameter results
plots <- list()
#define the function
chisholm_model <- function(area, theta, m0, K) {
rho = 1
K = K
Js = area*rho
J_stars = Js/K
ms = m0/sqrt(area)
gamma_stars = J_stars*ms/(1-ms)
return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
#FOR EACH DATASET IN THE LIST OF DATAFRAMES
#FIND THE COLUMN WITH SPECIES IN IT AND RENAME THIS SPECIES_RICH
for (j in 1:length(datasets)) {
x <- data.frame(datasets[j])
area <- x[5] #assign the area column of our dataframe to a vector
species_rich <- x[6] #assign the species richness column of our dataframe to a vector
data <- data.frame(area, species_rich) #bind into a new dataframe we will use for fitting
names(data) <- c("area", "species_rich") #rename the columns
data$area <- as.numeric(as.character(data$area)) #make sure all values are numeric or NA
data <- data[complete.cases(data),] #remove NAs
best_fit_results <- NA
best_plot_points <- NA
a <- 0 #for re-setting RSq value after each dataset fit
#Loop through the model fitting, with niche values (K) from 1 to maximum species richness
#calculate R^2 value and store best parameter results
for(K in 1:max(length(data$species_rich))) {
chisholm_fit <- try(nlsLM(species_rich ~ chisholm_model(area, theta, m0, K), data = data, start = list(theta = 200, m0 = 0.0005, K=K)), silent=T)
#Calculate the sum of squared errors - if there was no error in the model fitting!
if(class(chisholm_fit) != "try-error"){
RSS <- sum(residuals(chisholm_fit)^2) #Residual sum of squares of our NLLS model
TSS <- sum((data$species_rich - mean(data$species_rich))^2) #Total sum of squares
RSq <- 1 - (RSS/TSS) #R-squared value
#store these results
results <- data.frame(x[[2]][[1]], RSq, coef(chisholm_fit)["theta"], coef(chisholm_fit)["m0"], K)
names(results) <- c("Author", "R-Squared", "Theta", "Immigration", "Niches")
species <- chisholm_model(area = area, theta = coef(chisholm_fit)["theta"], m0 = coef(chisholm_fit)["m0"], K)
points_plot <- data.frame(area, species)
names(points_plot) <- c("area", "species")
#if the new RSq value is greater than the previous RSq value, store the results
if (RSq > a) {
best_fit_results <- results
best_plot_points <- points_plot
a <- RSq
}
} else {
results <- data.frame(x[[2]][[1]], NA, NA, NA, NA)
names(results) <- c("Author", "R-Squared", "Theta", "Immigration", "Niches")
best_fit_results <- results
}
}
points_list[[j]] <- best_plot_points #store best points for plotting
results_list[[j]] <- best_fit_results #store best RSq parameter results
if(!is.na(results_list[[j]][[2]])) {
#generate a vector of areas to for plotting our model fit
Area <- seq(min(data$area),max(data$area),len=length(data$area))
#remove incomplete cases from our plot points
best_plot_points <- best_plot_points[complete.cases(best_plot_points),]
#plot the most successful model fit with the data
p <- ggplot(data, aes(x=area, y=species_rich)) +
geom_point() +
xlab("Area") +
ylab("Species Richness") +
theme_bw() +
ggtitle(paste("Species-Area Relationship", x[[2]][[1]], x[[1]][[1]])) +
theme(plot.title = element_text(size = 10, face = "bold")) +
geom_line(data = best_plot_points, aes(x = area, y = species)) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.5),hjust=.2,label=paste("R-Squared", format(round(results_list[[j]][[2]], 2), nsmall = 2))) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.4),hjust=.2,label=paste("Theta", format(round(results_list[[j]][[3]], 2), nsmall = 2))) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.3),hjust=.2,label=paste("Immigration", format(round(results_list[[j]][[4]], 2), nsmall = 2))) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.2),hjust=.2,label=paste("Niches", results_list[[j]][[5]]))
plots[[j]] <- p
#Save plots
file_name = paste("../Results/Plots/plot_", x[[2]][[1]], ".pdf", sep="")
pdf(file_name)
print(plots[[j]])
dev.off()
}
}
merged_results <- do.call(rbind, results_list)
merged_results <- as.data.frame(merged_results)
rownames(merged_results) <- NULL
write.csv(merged_results, ("../Results/Stats_Results/TotalResults.csv"))
data
length(data$species_rich)
max(data$species_rich)
rm(list=ls())
graphics.off()
#install nlls fitting package
#install.packages("minpack.lm") <- if you've never installed minpack before
library("minpack.lm") #for nlls fitting
library("ggplot2")
folder <- "../Data/"  # path to folder that holds multiple .csv files
file_list <- list.files(path=folder, pattern="*.csv") # create list of all .csv files in folder
#load the csv files into a list
datasets <- lapply(file_list,
function(x)
read.csv(paste(folder, x, sep = ''),
stringsAsFactors = FALSE))
points_list <- list() #for storing our fitted points for plotting
results_list <- list() #for storing our RSq and parameter results
plots <- list()
#define the function
chisholm_model <- function(area, theta, m0, K) {
rho = 1
K = K
Js = area*rho
J_stars = Js/K
ms = m0/sqrt(area)
gamma_stars = J_stars*ms/(1-ms)
return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
#FOR EACH DATASET IN THE LIST OF DATAFRAMES
#FIND THE COLUMN WITH SPECIES IN IT AND RENAME THIS SPECIES_RICH
for (j in 1:length(datasets)) {
x <- data.frame(datasets[j])
area <- x[5] #assign the area column of our dataframe to a vector
species_rich <- x[6] #assign the species richness column of our dataframe to a vector
data <- data.frame(area, species_rich) #bind into a new dataframe we will use for fitting
names(data) <- c("area", "species_rich") #rename the columns
data$area <- as.numeric(as.character(data$area)) #make sure all values are numeric or NA
data <- data[complete.cases(data),] #remove NAs
best_fit_results <- NA
best_plot_points <- NA
a <- 0 #for re-setting RSq value after each dataset fit
#Loop through the model fitting, with niche values (K) from 1 to maximum species richness
#calculate R^2 value and store best parameter results
for(K in 1:max(data$species_rich)) {
chisholm_fit <- try(nlsLM(species_rich ~ chisholm_model(area, theta, m0, K), data = data, start = list(theta = 200, m0 = 0.0005, K=K)), silent=T)
#Calculate the sum of squared errors - if there was no error in the model fitting!
if(class(chisholm_fit) != "try-error"){
RSS <- sum(residuals(chisholm_fit)^2) #Residual sum of squares of our NLLS model
TSS <- sum((data$species_rich - mean(data$species_rich))^2) #Total sum of squares
RSq <- 1 - (RSS/TSS) #R-squared value
#store these results
results <- data.frame(x[[2]][[1]], RSq, coef(chisholm_fit)["theta"], coef(chisholm_fit)["m0"], K)
names(results) <- c("Author", "R-Squared", "Theta", "Immigration", "Niches")
species <- chisholm_model(area = area, theta = coef(chisholm_fit)["theta"], m0 = coef(chisholm_fit)["m0"], K)
points_plot <- data.frame(area, species)
names(points_plot) <- c("area", "species")
#if the new RSq value is greater than the previous RSq value, store the results
if (RSq > a) {
best_fit_results <- results
best_plot_points <- points_plot
a <- RSq
}
} else {
results <- data.frame(x[[2]][[1]], NA, NA, NA, NA)
names(results) <- c("Author", "R-Squared", "Theta", "Immigration", "Niches")
best_fit_results <- results
}
}
points_list[[j]] <- best_plot_points #store best points for plotting
results_list[[j]] <- best_fit_results #store best RSq parameter results
if(!is.na(results_list[[j]][[2]])) {
#generate a vector of areas to for plotting our model fit
Area <- seq(min(data$area),max(data$area),len=length(data$area))
#remove incomplete cases from our plot points
best_plot_points <- best_plot_points[complete.cases(best_plot_points),]
#plot the most successful model fit with the data
p <- ggplot(data, aes(x=area, y=species_rich)) +
geom_point() +
xlab("Area") +
ylab("Species Richness") +
theme_bw() +
ggtitle(paste("Species-Area Relationship", x[[2]][[1]], x[[1]][[1]])) +
theme(plot.title = element_text(size = 10, face = "bold")) +
geom_line(data = best_plot_points, aes(x = area, y = species)) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.5),hjust=.2,label=paste("R-Squared", format(round(results_list[[j]][[2]], 2), nsmall = 2))) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.4),hjust=.2,label=paste("Theta", format(round(results_list[[j]][[3]], 2), nsmall = 2))) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.3),hjust=.2,label=paste("Immigration", format(round(results_list[[j]][[4]], 2), nsmall = 2))) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.2),hjust=.2,label=paste("Niches", results_list[[j]][[5]]))
plots[[j]] <- p
#Save plots
file_name = paste("../Results/Plots/plot_", x[[2]][[1]], ".pdf", sep="")
pdf(file_name)
print(plots[[j]])
dev.off()
}
}
source('~/Documents/CMEECourseWork/Project/Code/Chisholm_ModFit.R')
rm(list=ls())
graphics.off()
#install nlls fitting package
#install.packages("minpack.lm") <- if you've never installed minpack before
library("minpack.lm") #for nlls fitting
library("ggplot2")
#####HERE WE LOAD ALL OF OUT DATASETS INTO A LIST OF DATAFRAMES#####
folder <- "../Data/"  # path to folder that holds multiple .csv files
file_list <- list.files(path=folder, pattern="*.csv") # create list of all .csv files in folder
#load the csv files into a list
datasets <- lapply(file_list,
function(x)
read.csv(paste(folder, x, sep = ''),
stringsAsFactors = FALSE))
points_list <- list() #for storing our fitted points for plotting
results_list <- list() #for storing our RSq and parameter results
plots <- list() #for storing our plots
#define the function
chisholm_model <- function(area, theta, m0, K) {
rho = 1
K = K
Js = area*rho
J_stars = Js/K
ms = m0/sqrt(area)
gamma_stars = J_stars*ms/(1-ms)
return(theta*(digamma(theta/K+gamma_stars*(digamma(gamma_stars+J_stars)-digamma(gamma_stars)))-digamma(theta/K)))
}
#FOR EACH DATASET IN THE LIST OF DATAFRAMES
#FIND THE COLUMN WITH SPECIES IN IT AND RENAME THIS SPECIES_RICH
for (j in 1:length(datasets)) {
x <- data.frame(datasets[j])
area <- x[5] #assign the area column of our dataframe to a vector
species_rich <- x[6] #assign the species richness column of our dataframe to a vector
data <- data.frame(area, species_rich) #bind into a new dataframe we will use for fitting
names(data) <- c("area", "species_rich") #rename the columns
data$area <- as.numeric(as.character(data$area)) #make sure all values are numeric or NA
data <- data[complete.cases(data),] #remove NAs
best_fit_results <- NA
best_plot_points <- NA
a <- 0 #for re-setting RSq value after each dataset fit
#Loop through the model fitting, with niche values (K) from 1 to maximum species richness
#calculate R^2 value and store best parameter results
for(K in 1:max(data$species_rich)) {
chisholm_fit <- try(nlsLM(species_rich ~ chisholm_model(area, theta, m0, K), data = data, start = list(theta = 200, m0 = 0.0005, K=K)), silent=T)
#Calculate the sum of squared errors - if there was no error in the model fitting!
if(class(chisholm_fit) != "try-error"){
RSS <- sum(residuals(chisholm_fit)^2) #Residual sum of squares of our NLLS model
TSS <- sum((data$species_rich - mean(data$species_rich))^2) #Total sum of squares
RSq <- 1 - (RSS/TSS) #R-squared value
#store these results
results <- data.frame(x[[2]][[1]], RSq, coef(chisholm_fit)["theta"], coef(chisholm_fit)["m0"], K)
names(results) <- c("Author", "R-Squared", "Theta", "Immigration", "Niches")
species <- chisholm_model(area = area, theta = coef(chisholm_fit)["theta"], m0 = coef(chisholm_fit)["m0"], K)
points_plot <- data.frame(area, species)
names(points_plot) <- c("area", "species")
#if the new RSq value is greater than the previous RSq value, store the results
if (RSq > a) {
best_fit_results <- results
best_plot_points <- points_plot
a <- RSq
}
} else {
results <- data.frame(x[[2]][[1]], NA, NA, NA, NA)
names(results) <- c("Author", "R-Squared", "Theta", "Immigration", "Niches")
best_fit_results <- results
}
}
points_list[[j]] <- best_plot_points #store best points for plotting
results_list[[j]] <- best_fit_results #store best RSq parameter results
if(!is.na(results_list[[j]][[2]])) {
#generate a vector of areas to for plotting our model fit
Area <- seq(min(data$area),max(data$area),len=length(data$area))
#remove incomplete cases from our plot points
best_plot_points <- best_plot_points[complete.cases(best_plot_points),]
#plot the most successful model fit with the data
p <- ggplot(data, aes(x=area, y=species_rich)) +
geom_point() +
xlab("Area") +
ylab("Species Richness") +
theme_bw() +
ggtitle(paste("Species-Area Relationship", x[[2]][[1]], x[[1]][[1]])) +
theme(plot.title = element_text(size = 10, face = "bold")) +
geom_line(data = best_plot_points, aes(x = area, y = species)) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.5),hjust=.2,label=paste("R-Squared", format(round(results_list[[j]][[2]], 2), nsmall = 2))) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.4),hjust=.2,label=paste("Theta", format(round(results_list[[j]][[3]], 2), nsmall = 2))) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.3),hjust=.2,label=paste("Immigration", format(round(results_list[[j]][[4]], 2), nsmall = 2))) +
annotate("text",x=(max(data$area)*0.7),y=(max(data$species_rich)*0.2),hjust=.2,label=paste("Niches", results_list[[j]][[5]]))
plots[[j]] <- p
#Save plots
file_name = paste("../Results/Plots/plot_", x[[2]][[1]], ".pdf", sep="")
pdf(file_name)
print(plots[[j]])
dev.off()
}
}
merged_results <- do.call(rbind, results_list)
merged_results <- as.data.frame(merged_results)
rownames(merged_results) <- NULL
write.csv(merged_results, ("../Results/Stats_Results/TotalResults.csv"))
source('~/Documents/CMEECourseWork/Project/Code/Chisholm_ModFit_Solman.R')
View(datasets)
View(datasets)
source('~/Documents/CMEECourseWork/Project/Code/Chisholm_ModFit_Solman.R')
x
source('~/Documents/CMEECourseWork/Project/Code/Chisholm_ModFit_LogArea.R')
source('~/Documents/CMEECourseWork/Project/Code/Chisholm_ModFit_LogAreaSpecies.R')
source('~/Documents/CMEECourseWork/Project/Code/Chisholm_ModFit_LogAreaSpecies_Solman.R')
source('~/Documents/CMEECourseWork/Project/Code/Chisholm_ModFit_LogArea_Solman.R')
